# Домашняя работа №10 + №11
<details><summary>## Mittre Att&ck / Re&ct / D3fence</summary>

Все эти матрицы структурированы для того, чтобы помочь специалистам по кибербезопасности понять, как происходят атаки и какие защитные меры можно использовать для защиты или реагирования.

### **MITRE ATT&CK** (Adversarial Tactics, Techniques, and Common Knowledge)
   - Это база данных, которая описывает тактики и техники, используемые злоумышленниками для выполнения кибератак.
   - **Техники** — конкретные методы, которые используют хакеры (например, фишинг или кража учетных данных).
   - **Тактики** — это более высокоуровневые этапы атаки, такие как начальный доступ, движение по сети, эксфильтрация данных и т.д.
   - **ATT&CK Navigator** — это инструмент для создания и отслеживания сценариев кибератак на основе этой базы данных.

**Как выглядит:**
- Это таблица, где каждый столбец представляет собой определённую **тактику** (например, разведка, доступ, перемещение, эксфильтрация данных).
- Внутри каждого столбца находятся **техники** — конкретные методы, которые злоумышленники могут использовать для выполнения тактики. Например, в колонке "Initial Access" может быть техника фишинга, в колонке "Execution" — удалённое выполнение кода.

![MITRE ATT&CK Matrix Example](https://attack.mitre.org/theme/images/navigator-example.png)

**Основные тактики:**
- Initial Access (Начальный доступ)
- Execution (Исполнение)
- Persistence (Удержание доступа)
- Privilege Escalation (Эскалация привилегий)
- Defense Evasion (Избежание защиты)
- Credential Access (Доступ к учетным данным)
- Discovery (Разведка)
- Lateral Movement (Перемещение по сети)
- Collection (Сбор данных)
- Exfiltration (Экфильтрация данных)
- Impact (Воздействие)

**Где посмотреть:**
- **[MITRE ATT&CK](https://attack.mitre.org/)**


### **MITRE D3FEND**
   - Это аналог матрицы ATT&CK, но с фокусом на **защитные меры**. D3FEND помогает строить защиту, описывая методы предотвращения атак.
   - В матрице D3FEND описаны различные техники защиты, такие как анализ сетевого трафика, управление идентификацией и аутентификацией, мониторинг и журналирование.

**Как выглядит:**
- Похожа на матрицу ATT&CK, но с акцентом на **защитные техники**. В столбцах также представлены тактики, а строки — это конкретные защитные меры, которые можно предпринять для противодействия атакам.

![MITRE D3FEND Matrix Example](https://i0.wp.com/bsg.tech/blog/wp-content/uploads/2021/06/Screenshot-2021-06-25-at-19.13.47.png?resize=1024%2C493&ssl=1)

Пример тактик:
- Data Protection (Защита данных)
- Network Segmentation (Сегментация сети)
- Endpoint Security (Безопасность конечных точек)
- Access Control (Контроль доступа)

**Где посмотреть:**
- **[MITRE D3FEND](https://d3fend.mitre.org/)**


### **RE&CT (Response and Containment Techniques)**
   - **RE&CT** — это матрица реагирования на инциденты, которая описывает действия по обнаружению и устранению атак.
   - Она фокусируется на мерах, которые необходимо принять после атаки для предотвращения её распространения и минимизации ущерба.
   - Пример действий: изоляция заражённой системы, сбор доказательств для анализа инцидента и восстановление нормальной работы системы.

**Как выглядит:**
- Матрица реагирования на инциденты. Здесь представлены шаги по обнаружению, сдерживанию, устранению последствий и восстановлению после кибератак.
- В столбцах отображаются этапы реагирования (например, "Containment" — Сдерживание, "Remediation" — Устранение), а строки — конкретные действия, которые можно предпринять.

![RE&CT Matrix Example](https://media.licdn.com/dms/image/v2/D4E22AQGI55fz0gIUOA/feedshare-shrink_800/feedshare-shrink_800/0/1719128419265?e=2147483647&v=beta&t=OvfpvZrCcq0-kEeSedSCfJ6mMTu7ZUuyFBTwFNZOaR4)

Пример тактик:
- Containment (Сдерживание)
- Investigation (Расследование)
- Eradication (Удаление)
- Recovery (Восстановление)
- Communication (Коммуникации)

**Где посмотреть:**
- **[RE&CT Matrix](https://atc-project.github.io/react-navigator/)**

---------------------------------------------------------------------------------------------------------------------------------------------------------
</details>


### 1. Вы – хакер, находящийся в интернете, вам необходимо проникнуть внутрь инфраструктуры и скомпрометировать 2 цели, применяя матрицу Att&ck:
   <br>1-ая - компьютер глав. буха компании
   <br>2-ая - ноутбук системного администратора<br>
![](pics/hw1011.png)
<details><summary>Выполнение:</summary>
   
### Часть 1: Атака на главного бухгалтера и системного администратора с применением матрицы MITRE ATT&CK

#### Цель 1: Проникновение на компьютер главного бухгалтера

**Этапы атаки:**

1. **Разведка (Reconnaissance)**:
   - **T1595.002 (Gather Victim Network Information)**: Сбор информации о внутренних сетях компании через публичные источники, такие как веб-сайты, форумы или социальные сети сотрудников.
   - **T1592.001 (Gather Victim Host Information)**: Использование инструментов сбора данных для обнаружения IP-адресов и хостов, связанных с бухгалтерией.

2. **Инициализация доступа (Initial Access)**:
   - **T1566 (Phishing)**: Проведение фишинг-атаки с использованием специально созданных электронных писем, которые выглядят как официальные запросы от финансовых организаций.
   - **T1190 (Exploit Public-Facing Application)**: Эксплуатация уязвимостей в веб-приложениях компании для входа в систему.

3. **Исполнение (Execution)**:
   - **T1204 (User Execution)**: Приманка с вредоносным вложением (PDF с поддельным финансовым отчетом), которое запускается пользователем.
   - **T1059 (Command and Scripting Interpreter)**: Выполнение вредоносного кода через командную строку или PowerShell для получения контроля.

4. **Перемещение по сети (Lateral Movement)**:
   - **T1021.001 (Remote Services: Remote Desktop Protocol)**: Использование RDP для перемещения по сети к компьютеру главного бухгалтера после получения паролей.
   - **T1078 (Valid Accounts)**: Использование украденных или скомпрометированных учетных данных для входа.

5. **Экфильтрация данных (Exfiltration)**:
   - **T1041 (Exfiltration Over C2 Channel)**: Передача украденных данных (финансовые отчеты) через Command and Control сервер.
   - **T1020 (Automated Exfiltration)**: Автоматизация передачи данных для быстрого извлечения.

#### Цель 2: Проникновение на ноутбук системного администратора

**Этапы атаки:**

1. **Разведка (Reconnaissance)**:
   - **T1595.001 (Active Scanning)**: Сканирование сетей и устройств для выявления уязвимостей системного администратора.

2. **Инициализация доступа (Initial Access)**:
   - **T1566.001 (Phishing: Spearphishing Attachment)**: Отправка персонализированного письма с вложением для системного администратора, которое имитирует запрос на обслуживание сетевого оборудования.
   
3. **Исполнение (Execution)**:
   - **T1059.003 (Command-Line Interface)**: Использование командной строки для запуска удаленного исполнения команд после компрометации.
   - **T1106 (Execution through API)**: Эксплуатация API системного администратора для исполнения команд.

4. **Повышение привилегий (Privilege Escalation)**:
   - **T1078 (Valid Accounts)**: Использование учетной записи с повышенными привилегиями, полученной через фишинг.

5. **Поддержание присутствия (Persistence)**:
   - **T1098 (Account Manipulation)**: Создание скрытой учетной записи с правами администратора для поддержания доступа.

6. **Эскалация привилегий (Elevation)**:
   - **T1078.003 (Administrative Accounts)**: Использование административной учетной записи для получения полного контроля над ноутбуком системного администратора.

---------------------------------------------------------------------------------------------------------------------------------------------------------

</details>

### 2. Разработать план защиты и план реагирования на атаку, которую вы провели гипотетически в предыдущем задании. Используя матрицы D3fence и Re&ct:
_p.s. У вас есть базы данных, AD DC, Cisco ASA, FTP / NFC servers, Wi-Fi routers, Web server ISS/ Nginx, внешние и внутренние ресурсы_

<details><summary>Выполнение:</summary>

#### Защита (Используя матрицу MITRE D3FEND)

1. **Сегментация сети**:
   - **D3-NS003 (Network Segmentation)**: Использовать сетевую сегментацию для защиты финансовых и административных сегментов сети.
   - **D3-ND001 (Network Traffic Analysis)**: Настроить анализ сетевого трафика для выявления подозрительных аномалий.

2. **Многофакторная аутентификация (MFA)**:
   - **D3-AD003 (Identity and Authentication Tracking)**: Внедрить MFA для всех критически важных учетных записей, таких как системный администратор и главный бухгалтер.

3. **Мониторинг и журналирование**:
   - **D3-LG001 (Centralized Log Management)**: Настроить централизованное управление логами для отслеживания подозрительных активностей в реальном времени.
   - **D3-DM001 (Endpoint Detection and Response)**: Использовать решения для обнаружения и ответа на инциденты на конечных точках (EDR).

4. **Шифрование данных**:
   - **D3-DA001 (Data Encryption)**: Обеспечить шифрование конфиденциальных данных как в состоянии покоя, так и при передаче, особенно для финансовых данных.

5. **Антивирусное ПО и защита от ВПО**:
   - **D3-MW001 (Malware Detection and Prevention)**: Использовать антивирусные решения и инструменты обнаружения ВПО для предотвращения атак.


#### Реакция на инцидент (Используя матрицу RE&CT)

1. **Обнаружение инцидента**:
   - **RE-001 (Alerting)**: Системы мониторинга должны поднять тревогу при обнаружении подозрительной активности, такой как ненормальный сетевой трафик или подозрительные команды на административных устройствах.

2. **Изоляция и блокировка**:
   - **RE-006 (Containment)**: Изоляция заражённого компьютера главного бухгалтера и ноутбука системного администратора от остальной сети для предотвращения распространения атаки.

3. **Анализ и восстановление**:
   - **RE-007 (Forensics Analysis)**: Провести цифровую экспертизу для анализа источника атаки, используемых уязвимостей и масштаба компрометации.
   - **RE-008 (Restore Operations)**: Восстановить операции на скомпрометированных системах, обновив пароли и учётные записи, а также устранить уязвимости.

4. **Оповещение и отчётность**:
   - **RE-009 (Reporting)**: Оповещение заинтересованных сторон и составление отчётов об инциденте для дальнейшего анализа.

5. **Анализ инцидента и улучшение защитных мер**:
   - **RE-010 (Post-Incident Review)**: Провести пост-инцидентный анализ для внесения улучшений в системы безопасности.


### Ссылки на ресурсы:

- **[MITRE ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/)** — для построения сценария атаки.
- **[MITRE D3FEND](https://d3fend.mitre.org)** — для планирования защиты.
- **[RE&CT Navigator](https://atc-project.github.io/react-navigator/)** — для разработки плана реагирования на инциденты.

---------------------------------------------------------------------------------------------------------------------------------------------------------

</details>


### Ссылки на дополнительные ресурсы
[Mittre ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/)<br>
[Mittre ATT&CK](https://attack.mitre.org/)<br>
[https://roadmap.sh/cyber-security](https://roadmap.sh/cyber-security)<br>
[Mittre ATT$CK defend](https://d3fend.mitre.org)<br>
[React Matrix](https://atc-project.github.io/react-navigator/)<br>
[APT Groups and Operations](https://docs.google.com/spreadsheets/d/1H9_xaxQHpWaa4O_Son4Gx0YOIzlcBWMsdvePFX68EKU/edit?pli=1&gid=1636225066#gid=1636225066)
